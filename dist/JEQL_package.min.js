!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.JEQL=t():e.JEQL=t()}(self,(()=>(()=>{var e={576:()=>{function e(e,t){let n=document.createElement("link");return n.rel="stylesheet",n.type="text/css",n.href=e,n.id=t,n}function t(e,t){null===document.getElementById(t.id)&&e.appendChild(t)}!function(){let n="";n="file:"===window.location.protocol?"../JEQL/":"/apps/JEQL/";let i=document.getElementsByTagName("head")[0];t(i,function(e,t){let n=document.createElement("link");return n.rel="stylesheet",n.href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700;900&display=swap",n.id="jeql_css_font",n}()),t(i,e(n+"JEQL.css","jeql_css_main")),t(i,e(n+"spinner/spinner.css","jeql_css_spinner"))}()}},t={};function n(i){var l=t[i];if(void 0!==l)return l.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,n),o.exports}n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return(()=>{"use strict";n.d(i,{default:()=>$t});var e={};n.r(e),n.d(e,{HTTP_STATUS_DEFAULT:()=>r,RequestConfig:()=>u,jsonToUrlEncoded:()=>a,make:()=>p,makeBody:()=>m,makeEmpty:()=>b,makeJson:()=>f,makeSimple:()=>E,urlEncodedToJson:()=>s});var t={};function l(){let e=document.createElement("div");e.setAttribute("class","jeql-spinner-outer");let t=document.createElement("div");t.setAttribute("class","jeql-spinner"),e.appendChild(t),document.body.appendChild(e)}function o(){document.body.removeChild(document.getElementsByClassName("jeql-spinner-outer")[0])}n.r(t),n.d(t,{ACTION_INTERNAL_APPLICATIONS:()=>x,ACTION_INTERNAL_APPLICATIONS_ADD:()=>M,ACTION_INTERNAL_APPLICATIONS_DEL:()=>R,ACTION_INTERNAL_APPLICATIONS_DELCONF:()=>w,ACTION_INTERNAL_ASSIGNED_DATABASES:()=>P,ACTION_INTERNAL_ASSIGNED_DATABASE_ADD:()=>F,ACTION_INTERNAL_ASSIGNED_DATABASE_DEL:()=>H,ACTION_INTERNAL_ASSIGNED_DATABASE_DELCONF:()=>G,ACTION_INTERNAL_CONFIG:()=>U,ACTION_INTERNAL_CONFIG_ADD:()=>J,ACTION_INTERNAL_CONFIG_AUTH:()=>Q,ACTION_INTERNAL_CONFIG_AUTH_ADD:()=>$,ACTION_INTERNAL_CONFIG_AUTH_DEL:()=>z,ACTION_INTERNAL_CONFIG_AUTH_DELCONF:()=>X,ACTION_INTERNAL_CONFIG_DEL:()=>K,ACTION_INTERNAL_CONFIG_DELCONF:()=>Y,ACTION_INTERNAL_DATABASES:()=>B,ACTION_INTERNAL_DATABASES_ADD:()=>D,ACTION_INTERNAL_DATABASES_DEL:()=>k,ACTION_INTERNAL_DATABASES_DELCONF:()=>q,ACTION_INTERNAL_DATASETS:()=>W,ACTION_INTERNAL_DATASETS_ADD:()=>V,ACTION_INTERNAL_DATASETS_DEL:()=>Z,ACTION_INTERNAL_DATASETS_DELCONF:()=>ee,ACTION_INTERNAL_NODES:()=>S,ACTION_INTERNAL_NODES_ADD:()=>y,ACTION_INTERNAL_NODES_DEL:()=>_,ACTION_INTERNAL_NODES_DELCONF:()=>C,ACTION_INTERNAL_NODE_AUTHS:()=>L,ACTION_INTERNAL_NODE_AUTHS_ADD:()=>O,ACTION_INTERNAL_NODE_AUTHS_DEL:()=>v,ACTION_INTERNAL_NODE_AUTHS_DELCONF:()=>j,CLS_BUTTON:()=>Ce,CLS_BUTTON_NO:()=>Oe,CLS_BUTTON_YES:()=>Le,CLS_MODAL:()=>Se,CLS_MODAL_AUTO:()=>_e,CLS_MODAL_WIDE:()=>ye,HTTP_STATUS_ACCEPTED:()=>g,HTTP_STATUS_DEFAULT:()=>T,HTTP_STATUS_OK:()=>h,KEY_ADDRESS:()=>ae,KEY_APPLICATION:()=>fe,KEY_COLUMNS:()=>re,KEY_CONFIGURATION:()=>pe,KEY_CREATE:()=>Ae,KEY_CREATE_USERNAME:()=>Ie,KEY_DATA:()=>ge,KEY_DATABASE:()=>ie,KEY_DATASET:()=>te,KEY_DELETED:()=>se,KEY_DESCRIPTION:()=>me,KEY_DROP:()=>Ne,KEY_FORCE_TRANSACTIONAL:()=>le,KEY_NAME:()=>he,KEY_NODE:()=>ne,KEY_PASSWORD:()=>ce,KEY_PORT:()=>ue,KEY_PRECEDENCE:()=>Te,KEY_ROLE:()=>Ee,KEY_ROWS:()=>oe,KEY_URL:()=>be,KEY_USERNAME:()=>de,doConfirmDelete:()=>lt,elemBuilder:()=>Et,fetchMyApplications:()=>Ft,foreach:()=>Rt,formQuery:()=>Kt,formatAsTableHeader:()=>Ot,getAppUrl:()=>Ht,getOrSelectAppConfig:()=>qt,getPagedSearchingTableRefreshButton:()=>ut,getSearchObj:()=>nt,init:()=>Gt,initAsPublic:()=>Pt,makeBuildable:()=>bt,modalExists:()=>it,objectsToTuples:()=>ft,pagedSearchingTable:()=>st,pagedTableUpdate:()=>rt,render:()=>wt,renderModal:()=>ht,renderModalAreYouSure:()=>Nt,renderModalError:()=>At,renderModalOk:()=>gt,requests:()=>e,scriptParent:()=>Mt,setPagedSearchingTableSortField:()=>at,simpleSearchTransformer:()=>ot,submit:()=>Qt,submitFile:()=>Yt,tableRenderer:()=>mt,tupleToObject:()=>ct,tuplesToObjects:()=>pt}),n(576);let r="DEFAULT";class u{constructor(e,t,n,i,r,u,a,s=null,d=null,c=l,p=o){this.base=t,this.authLocked=!0,this.authQueue=[],this.applicationName=e,this.authAction=n,this.refreshAction=i,this.loginFunc=r,this.refreshFunc=u,this.authToken=null,this.createSpinner=c,this.destroySpinner=p,this.authTokenSetFunc=s,this.setXHttpAuth=a,this.rememberMe=!0,this.logoutFunc=d,this.parent=null}clone(){let e=new u(this.applicationName,this.base,this.authAction,this.refreshAction,this.loginFunc,this.refreshFunc,this.setXHttpAuth,this.authTokenSetFunc,this.logoutFunc,this.createSpinner,this.destroySpinner);return e.rememberMe=this.rememberMe,e.parent=this,e.authLocked=!1,e}getApplicationName(){return this.applicationName}getStorage(){return this.rememberMe?window.localStorage:window.sessionStorage}getInvertedStorage(){return this.rememberMe?window.sessionStorage:window.localStorage}logout(e=!0,t=!1){null!==this.loginFunc&&this.logoutFunc(this.getStorage(),e,t,this.getInvertedStorage())}resetAuthToken(){this.authToken=null,null!==this.authTokenSetFunc&&this.authTokenSetFunc(this.getStorage(),this.authToken)}setAuthToken(e){for(this.authToken=e,null!==this.authTokenSetFunc&&this.authTokenSetFunc(this.getStorage(),this.authToken),this.authLocked=!1;0!==this.authQueue.length;)this.authQueue.pop()();null!==this.parent&&this.parent.setAuthToken(e)}}function a(e,t,n){if(n=n||[],"object"==typeof e)for(let i in e)a(e[i],t?t+"["+i+"]":i,n);else n.push(t+"="+encodeURIComponent(e));return n.join("&")}function s(e){let t=Array.from(e.split("&")),n={};for(let e in t)n[t[e].split("=")[0]]=decodeURIComponent(t[e].split("=")[1]);return n}function d(e){return e.getResponseHeader("Content-Type").startsWith("application/json")?JSON.parse(e.response):e.response}function c(e,t,n,i,l){e.createSpinner(),void 0!==i&&void 0===l&&"GET"!==n?(t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.send(i)):void 0!==l&&void 0===i&&"GET"!==n?(t.setRequestHeader("Content-Type","application/json; charset=utf-8"),t.send(l)):void 0!==l&&void 0!==i&&"GET"!==n?alert("Tell the developer off! They've provided both json and body data. Naughty"):t.send()}function p(e,t,n,i,l,o=!0){e.authLocked&&o&&this.authQueue.push((function(){p(e,t,n,i,l)}));let u=t.split(" ")[1],a=e.base+u,s=t.split(" ")[0],f=t===e.authAction,m=t===e.refreshAction;if(null===e.authToken&&!f){let o=function(){p(e,t,n,i,l)};return void e.loginFunc(e,o)}let b=new XMLHttpRequest;b.onreadystatechange=function(){let o=null,u=null;4===this.readyState&&(e.destroySpinner(),u=n,n=function(e,t){return e?e.constructor===Object?e.hasOwnProperty(t)?e[t]:null:200===t?e:null:null}(n,this.status),o=d(this)),4===this.readyState&&200===this.status?f||m?(e.setAuthToken(o),n()):n(o):4===this.readyState&&202===this.status?f&&u(o,!0):4===this.readyState&&401===this.status?f?u("Credentials incorrect. Please try again"):m?(e.resetAuthToken(),e.loginFunc(e,(function(){p(e,t,u,i,l)}),"Credentials expired. Please login again")):e.refreshFunc(e,(function(){p(e,t,u,i,l)})):4===this.readyState&&(f?n(this.response):null!==n?n(o,e,t,u,i,l):r in u?u[r](o,e,t,u,i,l):console.error("Unexpected response code from server: "+this.status+" response: "+this.response))},"GET"===s&&void 0!==i&&(a+="?"+i),b.open(s,a,!0),f||e.setXHttpAuth(e,b),c(e,b,s,i,l)}function f(e,t,n,i){p(e,t,n,void 0,JSON.stringify(i))}function m(e,t,n,i){p(e,t,n,a(i))}function b(e,t,n){p(e,t,n)}function E(e,t,n,i,l){let o=t.split(" ")[1],r=e.base+o,u=t.split(" ")[0],a=new XMLHttpRequest;a.onreadystatechange=function(){4===this.readyState&&e.destroySpinner(),4===this.readyState&&200===this.status?n(d(this)):4===this.readyState&&401===this.status&&console.log("Unexpected credential challenge for request type simple")},"GET"===u&&void 0!==i&&(r+="?"+i),a.open(u,r,!0),c(e,a,u,i,l)}let T=r;console.log("Loaded JEQL library, version 1.2.0");let h=200,g=202,A="JAAQL_TOKENS",N="JAAQL_CONFIGS",I="POST /oauth/token",S="GET /internal/nodes",y="POST /internal/nodes",_="DELETE /internal/nodes",C="POST /internal/nodes/confirm-deletion",L="GET /internal/nodes/credentials",O="POST /internal/nodes/credentials",v="DELETE /internal/nodes/credentials",j="POST /internal/nodes/credentials/confirm-deletion",B="GET /internal/databases",D="POST /internal/databases",k="DELETE /internal/databases",q="POST /internal/databases/confirm-deletion",x="GET /internal/applications",M="POST /internal/applications",R="DELETE /internal/applications",w="POST /internal/applications/confirm-deletion",P="GET /internal/applications/configurations/assigned-databases",F="POST /internal/applications/configurations/assigned-databases",H="DELETE /internal/applications/configurations/assigned-databases",G="POST /internal/applications/configurations/assigned-databases/confirm-deletion",U="GET /internal/applications/configurations",J="POST /internal/applications/configuration",K="DELETE /internal/applications/configurations",Y="POST /internal/applications/configurations/confirm-deletion",Q="GET /internal/applications/configurations/authorizations",$="POST /internal/applications/configurations/authorizations",z="DELETE /internal/applications/configurations/authorizations",X="POST /internal/applications/configurations/authorizations/confirm-deletion",W="GET /internal/applications/datasets",V="POST /internal/applications/datasets",Z="DELETE /internal/applications/datasets",ee="POST /internal/applications/datasets/confirm-deletion",te="dataset",ne="node",ie="database",le="force_transactional",oe="rows",re="columns",ue="port",ae="address",se="deleted",de="username",ce="password",pe="configuration",fe="application",me="description",be="url",Ee="role",Te="precedence",he="name",ge="data",Ae="create",Ne="drop",Ie="create_username",Se="jeql-modal",ye="jeql-modal-wide",_e="jeql-modal-auto",Ce="jeql-button",Le="jeql-button-yes",Oe="jeql-button-no",ve="jeql-table-header-sort",je="jeql-table-header-sort-span",Be="&nbsp;-",De="&nbsp;&#9650;",ke="&nbsp;&#9660;",qe="jeql-data",xe="jeql-paging-table",Me="jeql-sort-direction",Re="jeql-login-error",we="jeql-username",Pe="jeql-password",Fe="jeql-remember-me",He="jeql-mfa-0",Ge="jeql-mfa-1",Ue="jeql-mfa-2",Je="jeql-mfa-3",Ke="jeql-mfa-4",Ye="jeql-mfa-5",Qe="jeql-login-button",$e="jeql-select-app-config-",ze="refresh",Xe="filtered",We="total",Ve="pages",Ze="size",et="from",tt="sort";function nt(e,t,n,i){let l={};return l.page=e,l.size=t,l.search=n,l.sort=i,l}function it(){return 0!==document.body.getElementsByClassName(Se).length}function lt(e,t,n,i,l){m(window.JEQL_CONFIG,n,(function(e){(t={}).deletion_key=e.deletion_key,f(window.JEQL_CONFIG,i,l,t)}),t)}function ot(e){return function(t){if(""===t)return t;let n="";for(let i=0;i<e.length;i++)0!==i&&(n+=" OR "),n+=e[i]+" LIKE '%"+t+"%'";return n}}function rt(e,t){let n=e.id,i=n+"-"+ze,l=n+"-"+We,o=n+"-"+Xe,r=n+"-"+et,u=n+"-to",a=document.getElementById(n+"-cur"),s=parseInt(a.innerText),d=document.getElementById(n+"-"+Ve),c=parseInt(document.getElementById(n+"-"+Ze).value),p=Math.ceil(t.records_filtered/c),f=function(e){a.innerText=e.target.innerHTML,document.getElementById(i).click()};if(d.innerHTML="",d.appendChild(Et("button").buildText("1").buildBoolean("disabled",1===s).buildEventListener("click",f)),s>3&&(p<8||4===s?d.appendChild(Et("button").buildText("2").buildBoolean("disabled",2===s).buildEventListener("click",f)):d.appendChild(Et("button").buildText("...").buildBoolean("disabled",!0))),p>6&&p===s){let e=s-4;d.appendChild(Et("button").buildText(e.toString()).buildBoolean("disabled",s===e).buildEventListener("click",f))}if(p>5&&p-s<2&&s>5){let e=s-3;d.appendChild(Et("button").buildText(e.toString()).buildBoolean("disabled",s===e).buildEventListener("click",f))}if(p>4&&p-s<3&&s>4){let e=s-2;d.appendChild(Et("button").buildText(e.toString()).buildBoolean("disabled",s===e).buildEventListener("click",f))}if(p>1&&s-1!==p){let e=s>2?s-1:2;d.appendChild(Et("button").buildText(e.toString()).buildBoolean("disabled",s===e).buildEventListener("click",f))}if(p>2&&s!==p){let e=s>3?s:3;d.appendChild(Et("button").buildText(e.toString()).buildBoolean("disabled",s===e).buildEventListener("click",f))}if(p>3&&s<p&&(p!==s+1||4===p)){let e=s>3?s+1:4;d.appendChild(Et("button").buildText(e.toString()).buildBoolean("disabled",s===e).buildEventListener("click",f))}if(p>6&&s<4){let e=5;d.appendChild(Et("button").buildText(e.toString()).buildBoolean("disabled",s===e).buildEventListener("click",f))}if(p-s>2&&p>5)if(p<8||p-s<4){let e=p-1;d.appendChild(Et("button").buildText(e.toString()).buildBoolean("disabled",s===e).buildEventListener("click",f))}else d.appendChild(Et("button").buildText("...").buildBoolean("disabled",!0));if(p>4||p===s&&(3===s||4===s)){let e=p;d.appendChild(Et("button").buildText(e.toString()).buildBoolean("disabled",s===e).buildEventListener("click",f))}document.getElementById(l).innerText=t.records_total,document.getElementById(o).innerText=t.records_filtered,document.getElementById(r).innerText=(s*c-c+1).toString(),document.getElementById(u).innerText=Math.min(s*c,t.records_filtered).toString()}function ut(e){return document.getElementById(e+"-"+ze)}function at(e,t){document.getElementById(e+"-"+tt).innerText=t}function st(e,t,n=null){n||(n=function(e){return e}),bt(e),e.buildBoolean(xe,!0);let i=e.id,l=i+"-"+ze,o=i+"-"+We,r=i+"-"+Xe,u=i+"-"+Ve,a=i+"-"+Ze,s=i+"-"+et,d=i+"-search",c=i+"-last-search",p=i+"-to",f=i+"-cur",m=i+"-"+tt;e.buildOlderSibling("div").buildHTML(`\n        <label>\n            Search: \n            <input type="text" id="${d}"/>\n        </label>\n        <label>\n            Page Size:\n            <select id="${a}">\n                <option value="10">10</option>\n                <option value="25">25</option>\n                <option value="50">50</option>\n                <option value="100">100</option>\n                <option value="250">250</option>\n                <option value="999999999">All</option>\n            </select>\n        </label>\n        <button id="${l}">Search</button>\n        <span id="${f}" style="display:none">1</span>\n        <span id="${m}" style="display:none"></span>\n        <span id="${c}" style="display:none"></span>\n    `),e.buildSibling("div").buildHTML(`\n        <div id="${u}"></div><div>Showing <span id="${s}"></span> to <span id="${p}"></span> of <span id="${r}"></span>/<span id="${o}"> records</span></div>\n    `),bt(document.getElementById(u)),document.getElementById(a).addEventListener("change",(function(){document.getElementById(f).innerText="1",t(0,parseInt(document.getElementById(a).value),n(document.getElementById(d).value),document.getElementById(m).innerText)})),document.getElementById(l).addEventListener("click",(function(){document.getElementById(c).innerHTML!==document.getElementById(d).value&&(document.getElementById(f).innerText="1"),document.getElementById(c).value=document.getElementById(d).value,t(parseInt(document.getElementById(f).innerText)-1,parseInt(document.getElementById(a).value),n(document.getElementById(d).value),document.getElementById(m).innerText)})),t(0,10,n(document.getElementById(d).value),"")}function dt(e,t){let n=Et(t);return e.appendChild(n),n}function ct(e,t){let n={};for(let i=0;i<t.length;i++)if(t[i].constructor===Object){let l=Object.keys(t[i])[0],o={};o[re]=t[i][l],o[oe]=e[i],n[l]=pt(o)}else n[t[i]]=e[i];return n}function pt(e){let t=e[re],n=e[oe],i=[];for(let e=0;e<n.length;e++)i.push(ct(n[e],t));return i}function ft(e){let t={};t[re]=[],t[oe]=[];for(let n=0;n<e.length;n++){0===n&&(t[re]=Object.keys(e[n]));let i=[];for(let l=0;l<t[re].length;l++)i.push(e[n][t[re][l]]);t[oe].push(i)}return t}function mt(e,t,n){let i=null,l=null;if(t){let e=t.getElementsByClassName(ve);for(let t=0;t<e.length;t++){let n=e[t].getElementsByClassName(je)[0];n.getAttribute(Me)!==Be&&(i=e[t].childNodes[0].data,l=n.getAttribute(Me))}t.innerHTML="",bt(t)}else t=Et(t),document.body.appendChild(t);let o=t.getAttribute(xe),r=t.buildChild("tr");for(let n in Object.keys(e[re])){let u=Ot(e[re][n]),a=r.buildChild("th").buildClass("jeql-table-header").buildText(u);if(o){a.buildClass(ve);let o=a.buildChild("span").buildClass(je).buildHTML(Be).buildAttr(Me,Be);u===i&&(o.buildAttr(Me,l),o.innerHTML=l),a.buildEventListener().buildEventListener("click",(function(){if(o.getAttribute(Me)===Be){o.innerHTML=De,o.setAttribute(Me,De);let i=t.getElementsByClassName(je);for(let e=0;e<i.length;e++)i[e]!==o&&(i[e].setAttribute(Me,Be),i[e].innerHTML=Be);at(t.id,e[re][n]+" ASC")}else o.getAttribute(Me)===De?(o.innerHTML=ke,o.setAttribute(Me,ke),at(t.id,e[re][n]+" DESC")):(o.innerHTML=Be,o.setAttribute(Me,Be),at(t.id,""));ut(t.id).click()}))}}r.buildChild("th");for(let i in e[oe]){let l=t.buildChild("tr"),o=function(){for(let t in e[oe][i])l.buildChild("td").buildText(e[oe][i][t])};n?n(l,e,i,o):o()}}function bt(e){return e.removeElement=function(){e.parentNode.removeChild(e)},e.buildClass=function(t){return function(e,t){Array.isArray(t)||(t=[t]);for(let n in t)e.classList.add(t[n]);return e}(e,t)},e.buildAttr=function(t,n){return function(e,t,n){return e.setAttribute(t,n),e}(e,t,n)},e.buildBoolean=function(t,n){return function(e,t,n){return n&&e.setAttribute(t,t),e}(e,t,n)},e.buildText=function(t){return function(e,t){return e.innerText=t,e}(e,t)},e.buildHTML=function(t){return function(e,t){return e.innerHTML+=t,e}(e,t)},e.buildChild=function(t){return dt(e,t)},e.buildRow=function(){return dt(e,"tr")},e.buildForeach=function(t,n){for(let i=0;i<t.length;i++)e.buildHTML(n(t[i]));return e},e.getParent=function(){return bt(e.parentNode)},e.buildSibling=function(t){return function(e,t){let n=Et(t);return e.after(n),n}(e,t)},e.buildEventListener=function(t,n){return function(e,t,n){return e.addEventListener(t,n),e}(e,t,n)},e.buildOlderSibling=function(t){return function(e,t){let n=Et(t);return e.parentNode.insertBefore(n,e),n}(e,t)},e}function Et(e){let t=document.createElement(e);return bt(t),t}function Tt(e,t){t.setRequestHeader("Authentication-Token",e.authToken)}function ht(e,t=!0,n=Se,i=null){let l=document.createElement("div");document.body.appendChild(l),l.setAttribute("class","jeql-modal-outer");let o=Et("div");if(l.appendChild(o),o.classList.add(n),null!==i&&o.classList.add(i),t){l.classList.add("jeql-cursor-pointer");let e=Et("span").buildClass("jeql-modal-close").buildHTML("&times;");o.appendChild(e),e.addEventListener("click",(function(){document.body.removeChild(l)})),l.addEventListener("click",(function(e){e.target===l&&document.body.removeChild(l)}),!1)}let r=o.buildChild("div");r.closeModal=function(){l.parentElement.removeChild(l)},e(r)}function gt(e,t=null,n="Success!"){t||(t=function(){}),ht((function(i){let l=i.closeModal;i.closeModal=function(){l(),t()},i.buildHTML(`\n            <h1>${n}</h1>\n            ${e}\n        `).buildChild("button").buildText("Ok").buildClass(Ce).buildEventListener("click",(function(){i.closeModal()}))}),!1)}function At(e,t="Error!"){}function Nt(e,t,n="Are you sure?",i="Yes",l="No"){ht((function(o){o.buildHTML(`\n            <h1>${n}</h1>\n            ${e}\n        `).buildChild("button").buildText(i).buildClass([Ce,Le]).buildEventListener("click",(function(){o.closeModal(),t()})).buildSibling("button").buildText(l).buildClass([Ce,Oe]).buildEventListener("click",o.closeModal)}),!1)}function It(e,t){document.getElementById(e).addEventListener("keyup",(function(e){13===e.keyCode&&(e.preventDefault(),document.getElementById(t).click())}))}function St(e,t,n=null){null===n&&(n=function(){document.getElementById(t).focus()}),document.getElementById(e).onkeypress=function(t){Number.parseInt(t.key)||0===Number.parseInt(t.key)?(document.getElementById(e).value=t.key,n()):t.preventDefault()}}function yt(e){let t={};return e?(t.mfa_key=document.getElementById(He).value+document.getElementById(Ge).value+document.getElementById(Ue).value+document.getElementById(Je).value+document.getElementById(Ke).value+document.getElementById(Ye).value,t.pre_auth_key=e):(t[de]=document.getElementById(we).value,t[ce]=document.getElementById(Pe).value),t}function _t(e,t){document.getElementById(Re).innerHTML=t+"<br>";let n=e.getElementsByClassName("jeql-input");for(let e in n)n.hasOwnProperty(e)&&(n[e].style.borderColor="red")}function Ct(e,t,n){ht((function(i){!function(e,t,n,i){e.id="jeql-login-modal",e.appendChild(Et("div").buildClass("jeql-center").buildHTML("\n        <h1>\n            Login\n        </h1>\n    "));let l=Et("div").buildHTML('\n        <span id=jeql-login-error style="color: red"></span>\n        <br>\n        <label class="jeql-strong">\n            Username\n            <input class="jeql-input jeql-input-full" type="text" placeholder="Enter username" id=jeql-username>\n        </label>\n        <label class="jeql-strong">\n            Password \n            <input class="jeql-input jeql-input-full" type="password" placeholder="Enter password" id=jeql-password>\n        </label>\n    ');e.appendChild(l),i&&(document.getElementById(Re).innerHTML=i+"<br>");let o=e.buildChild("div").buildHTML('\n        <label for=jeql-remember-me>Remember me</label>\n        <input type="checkbox" id=jeql-remember-me>\n    ');o.checked=t.rememberMe;let r=function(e){return e.buildChild("button").buildClass(Ce).buildText("Login").buildAttr("id",Qe)},u=Et("div"),a=r(u);e.appendChild(u),a.addEventListener("click",(function(){document.getElementById(Fe).checked!==t.rememberMe&&(t.logout(!1,!0),t.rememberMe=document.getElementById(Fe).checked),f(t,I,(function(i,a){if(a){l.innerHTML="",o.removeElement();let a=l.buildChild("span").buildAttr("style","display: none");u.innerHTML="";let s=u.buildChild("button").buildClass(Ce).buildText("Back");r(u),setTimeout((function(){a.innerText="MFA timeout hit. Please login again",s.click()}),12e4),s.addEventListener("click",(function(){e.closeModal();let i=null;0!==a.innerText.length&&(i=a.innerText),Ct(t,n,i)})),function(e,t,n,i,l){t.buildHTML('\n        <span id=jeql-login-error style="color: red"></span>\n        <br>\n        <label class="jeql-strong">\n            2FA\n            <br>\n            <div style="width: 100%; display: flex; gap: 1%">\n                <input class="jeql-input jeql-input-mfa" type="text" id=jeql-mfa-0 maxlength="1" size="1">\n                <input class="jeql-input jeql-input-mfa" type="text" id=jeql-mfa-1 maxlength="1" size="1">\n                <input class="jeql-input jeql-input-mfa" type="text" id=jeql-mfa-2 maxlength="1" size="1">\n                <input class="jeql-input jeql-input-mfa" type="text" id=jeql-mfa-3 maxlength="1" size="1">\n                <input class="jeql-input jeql-input-mfa" type="text" id=jeql-mfa-4 maxlength="1" size="1">\n                <input class="jeql-input jeql-input-mfa" type="text" id=jeql-mfa-5 maxlength="1" size="1">\n            </div>\n        </label>\n    '),St(He,Ge),St(Ge,Ue),St(Ue,Je),St(Je,Ke),St(Ke,Ye),St(Ye,null,(function(){document.getElementById(Qe).click()})),It(Ye,Qe),document.getElementById(Qe).addEventListener("click",(function(){f(n,I,(function(t){t?(_t(e,t),document.getElementById(He).focus(),document.getElementById(He).value="",document.getElementById(Ge).value="",document.getElementById(Ue).value="",document.getElementById(Je).value="",document.getElementById(Ke).value="",document.getElementById(Ye).value=""):(e.closeModal(),i())}),yt(l))})),document.getElementById(He).focus()}(e,l,t,n,i)}else i?(_t(e,i),document.getElementById(we).focus()):(e.closeModal(),n())}),yt())})),It(we,Qe),It(Pe,Qe),document.getElementById(we).focus()}(i,e,t,n)}),!1)}function Lt(e,t){b(e,e.refreshAction,t)}function Ot(e){let t="",n="_";for(let i=0;i<e.length;i++){let l=e[i];t+="_"===n?l.toUpperCase():l,n=l}return t.replace("_"," ")}function vt(e){let t=null,n=[];return location.search.substr(1).split("&").forEach((function(i){n=i.split("="),n[0]===e&&(t=decodeURIComponent(n[1]))})),t}function jt(e){let t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),n=decodeURIComponent(atob(t).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""));return JSON.parse(n)}function Bt(e,t){let n=e.getItem(t);return null===n?(n={},e.setItem(t,JSON.stringify(n))):n=JSON.parse(n),n}function Dt(e,t,n){let i={};i[fe]=e.getApplicationName(),i[pe]=n,m(e,"GET /configurations/assigned-databases",(function(i){!function(e,t,n,i){let l={};for(let e in i)l[i[e][te]]=i[e].connection;let o={};o.connections=l,o[he]=n;let r=Bt(e.getStorage(),N);r[e.base][e.getApplicationName()]=o,e.getStorage().setItem(N,JSON.stringify(r)),t(e)}(e,t,n,i)}),i)}function kt(e,t=null){null===t&&(t=function(){console.error("Tried to get app config in an imperative manner yet app config was not set")});let n={};n[fe]=e.getApplicationName(),m(e,"GET /configurations",(function(n){!function(e,t,n){1===n.length?Dt(e,t,n[0][pe]):0===n.length?console.error("No configuration found for user"):ht((function(i){let l=qt(e,null,!1,!0)[he];i.appendChild(Et("h1").buildText("Select Configuration"));let o=Et("table");i.appendChild(o);let r=o.buildChild("tr");for(let e in Object.keys(n[0]))r.buildChild("th").buildText(Ot(Object.keys(n[0])[e]));r.buildChild("th");for(let r in n){let u=o.buildChild("tr");n[r][pe]===l&&u.buildClass("jeql-selected-app-config");for(let e in n[r])u.buildChild("td").buildText(n[r][e]);u.buildChild("td").buildHTML(`\n                    <button id="${$e+r}" class="${Ce}">Select</button>\n                `),xt(document.getElementById($e+r),n[r]),document.getElementById($e+r).addEventListener("click",(function(n){var l;i.closeModal(),Dt(e,t,(l=n.target,JSON.parse(atob(l.getAttribute(qe))))[pe])}))}}),!1,ye)}(e,t,n)}),n)}function qt(e,t=null,n=!1,i=!1){let l=function(e,t=!1){try{let n=e.getApplicationName(),i=null;t&&(i=vt("configuration"));let l=Bt(e.getStorage(),N);if(null===i){let t={};e.base in l?t=l[e.base]:l[e.base]=t,n in t?i=t[n]:t[n]=i}else{i=i.split(",");let t=i.shift(),o=e=>({[jt(e).name]:e});o=Object.assign({},...i.map(o)),i={},i[he]=t,i.connections=o;let r={};e.base in l?r=l[e.base]:l[e.base]=r,r[n]=i}return e.getStorage().setItem(N,JSON.stringify(l)),i}catch(e){console.error("Error when loading app config, wiping config"),console.error(e),console.getStorage().removeItem(N)}}(e,n);if(null!==l&&l.constructor===Object&&"connections"in l&&he in l)return null!==t?void t(e):l;i||kt(e,t);let o={connections:{}};return o[he]=null,o}function xt(e,t){e.setAttribute(qe,btoa(JSON.stringify(t)))}function Mt(){return document.currentScript.parentElement}function Rt(e,t){e.constructor!==Object&&(e=Kt(window.JEQL_CONFIG,e)),Qt(window.JEQL_CONFIG,e,(function(e){for(let n=0;n<e[oe].length;n++)t(ct(e[oe][n],e[re]))}))}function wt(e,t,n){let i=t;t.constructor===Object&&(i=function(e){let n=null;if(0===e[oe].length)"alternative"in t&&t.alternative(e[re]);else{"introducer"in t&&(n=t.introducer(e[re]));for(let i=0;i<e[oe].length;i++)"expression"in t&&t.expression(e[oe][i],n),"separator"in t&&t.separator(e[oe][i],n);"terminator"in t&&t.terminator(e[re],n)}}),n||(n=window.JEQL_CONFIG),Qt(window.JEQL_CONFIG,e,i)}function Pt(){}function Ft(e,t){b(e,"GET /applications",t)}function Ht(e,t){Ft(e,(function(e){e=e[ge];for(let n in e)if(e[n][he]===t)return e[n][be];throw`Could not find application with name '${t}'`}))}function Gt(e,t,n=!0,i=null){null===t&&(t=function(){}),null===i&&(i=function(){let e=vt("jaaql");if(null!==e)return e;let t=window.location.protocol;return"file:"===t?t="http://127.0.0.1:6060":t+="/api",t}());let l=new u(e,i,I,"POST /oauth/refresh",Ct,Lt,Tt,(function(e,t){let n=Bt(e,A);n[i]=t,e.setItem(A,JSON.stringify(n))}),(function(e,t,n,i){n&&(i.setItem(A,e.getItem(A)),i.setItem(N,e.getItem(N))),e.removeItem(A),e.removeItem(N),t&&window.location.reload()}));window.JEQL_CONFIG=l,l.rememberMe=null!==window.localStorage.getItem(A);let o=Bt(l.getStorage(),A),r=null;return l.base in o&&(r=o[l.base]),l.authToken=r,qt(l.clone(),t,!0),l}function Ut(e,t){kt(t,(function(){console.error("Could not refresh app config connection token")}))}function Jt(e,t,n,i,l,o){let r=qt(t),u={};for(let e in r.connections)u[r.connections[e]]=e;Dt(t,(function(){let e=qt(t);o=o?JSON.parse(o):s(l);let r=!0;Array.isArray(o)||(r=!1,o=[o]);for(let t in o)o[t].connection=e.connections[u[o[t].connection]];r||(o=o[0]),l&&(l=a(o),o=void 0);let d={...i};d[419]=Ut,p(t,n,d,l,o)}),r[he])}function Kt(e,t,n=null,i=null,l=null){let o=function(e,t=null){let n=qt(e).connections;if(null===t){if(Object.keys(n).length>1)throw new Error("Must supply dataset as multiple datasets exist");return 0===n.length&&kt(e),n[Object.keys(n)[0]]}if(t in n)return n[t];throw new Error("Dataset '"+t+" does not exist")}(e,i);null===n&&(n={});let r={};return r.query=t,r.parameters=n,r.connection=o,r[ie]=l,r}function Yt(e,t,n){Qt(e,t,n,!1,!0)}function Qt(e,t,n,i=!1,l=!1){let o=n;n.constructor!==Object&&((n={})[h]=o),n[419]=i?Ut:Jt,f(e,l?"POST /submit-file":"POST /submit",n,t)}const $t=t})(),i.default})()));